<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="749px" preserveAspectRatio="none" style="width:898px;height:749px;" version="1.1" viewBox="0 0 898 749" width="898px" zoomAndPan="magnify"><defs><filter height="300%" id="f1frk02c3br0k7" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="734.9844" style="stroke: #A80036; stroke-width: 1.0;" width="104.5" x="382.5" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="391.25" y="16.0669">Blockchains</text><rect fill="#FFFFFF" filter="url(#f1frk02c3br0k7)" height="449.9922" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="399" y="172.1289"/><rect fill="#FFFFFF" filter="url(#f1frk02c3br0k7)" height="241.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="458" y="255.5273"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="210" x2="210" y1="86.2969" y2="652.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="403.5" x2="403.5" y1="86.2969" y2="652.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="463" x2="463" y1="86.2969" y2="652.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="663" x2="663" y1="86.2969" y2="652.6875"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="191" y="82.9951">Alice</text><ellipse cx="210" cy="13" fill="#FEFECE" filter="url(#f1frk02c3br0k7)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M210,21 L210,48 M197,29 L223,29 M210,48 L197,63 M210,48 L223,63 " fill="none" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="191" y="664.6826">Alice</text><ellipse cx="210" cy="677.9844" fill="#FEFECE" filter="url(#f1frk02c3br0k7)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M210,685.9844 L210,712.9844 M197,693.9844 L223,693.9844 M210,712.9844 L197,727.9844 M210,712.9844 L223,727.9844 " fill="none" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="386.5" y="82.9951">BTC</text><ellipse cx="404" cy="54" fill="#FEFECE" filter="url(#f1frk02c3br0k7)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="392" x2="416" y1="68" y2="68"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="386.5" y="664.6826">BTC</text><ellipse cx="404" cy="683.9844" fill="#FEFECE" filter="url(#f1frk02c3br0k7)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="392" x2="416" y1="697.9844" y2="697.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="443" y="82.9951">GRIN</text><ellipse cx="463" cy="54" fill="#FEFECE" filter="url(#f1frk02c3br0k7)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="451" x2="475" y1="68" y2="68"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="34" x="443" y="664.6826">GRIN</text><ellipse cx="463" cy="683.9844" fill="#FEFECE" filter="url(#f1frk02c3br0k7)" rx="12" ry="12" style="stroke: #A80036; stroke-width: 2.0;"/><line style="stroke: #A80036; stroke-width: 2.0;" x1="451" x2="475" y1="697.9844" y2="697.9844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="646" y="82.9951">Bob</text><ellipse cx="663" cy="13" fill="#FEFECE" filter="url(#f1frk02c3br0k7)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M663,21 L663,48 M650,29 L676,29 M663,48 L650,63 M663,48 L676,63 " fill="none" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="646" y="664.6826">Bob</text><ellipse cx="663" cy="677.9844" fill="#FEFECE" filter="url(#f1frk02c3br0k7)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M663,685.9844 L663,712.9844 M650,693.9844 L676,693.9844 M663,712.9844 L650,727.9844 M663,712.9844 L676,727.9844 " fill="none" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FFFFFF" filter="url(#f1frk02c3br0k7)" height="449.9922" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="399" y="172.1289"/><rect fill="#FFFFFF" filter="url(#f1frk02c3br0k7)" height="241.0625" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="458" y="255.5273"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="210" x2="252" y1="117.4297" y2="117.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="252" y1="117.4297" y2="130.4297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211" x2="252" y1="130.4297" y2="130.4297"/><polygon fill="#A80036" points="221,126.4297,211,130.4297,221,134.4297,217,130.4297" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="217" y="112.3638">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="230" y="112.3638">Create secret x</text><polygon fill="#A80036" points="387,168.1289,397,172.1289,387,176.1289,391,172.1289" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="210" x2="393" y1="172.1289" y2="172.1289"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="217" y="167.063">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="230" y="167.063">Create BTC 2-of-2 MuSig</text><path d="M8,143.4297 L8,183.4297 L201,183.4297 L201,153.4297 L191,143.4297 L8,143.4297 " fill="#FBFB77" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M191,143.4297 L191,153.4297 L201,153.4297 L191,143.4297 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="14" y="160.4966">Spends with: Bob's key &amp; x</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="14" y="175.6294">Expires in: 48h</text><polygon fill="#A80036" points="420,209.8281,410,213.8281,420,217.8281,416,213.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="414" x2="662" y1="213.8281" y2="213.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="426" y="208.7622">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="439" y="208.7622">Inspect MuSig</text><polygon fill="#A80036" points="479,251.5273,469,255.5273,479,259.5273,475,255.5273" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="473" x2="662" y1="255.5273" y2="255.5273"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="485" y="250.4614">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="498" y="250.4614">Create GRIN 2-of-2 MuSig</text><path d="M668,226.8281 L668,266.8281 L886,266.8281 L886,236.8281 L876,226.8281 L668,226.8281 " fill="#FBFB77" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M876,226.8281 L876,236.8281 L886,236.8281 L876,226.8281 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="674" y="243.895">Spends with: aliceSig + bobSig</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="674" y="259.0278">Expires in: 24h</text><polygon fill="#A80036" points="446,293.2266,456,297.2266,446,301.2266,450,297.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="210" x2="452" y1="297.2266" y2="297.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="217" y="292.1606">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="230" y="292.1606">Inspect MuSig</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="210" x2="252" y1="326.3594" y2="326.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="252" y1="326.3594" y2="339.3594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="211" x2="252" y1="339.3594" y2="339.3594"/><polygon fill="#A80036" points="221,335.3594,211,339.3594,221,343.3594,217,339.3594" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="217" y="321.2935">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="230" y="321.2935">Create adaptorSig</text><path d="M16,311.7266 L16,336.7266 L201,336.7266 L201,321.7266 L191,311.7266 L16,311.7266 " fill="#FBFB77" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M191,311.7266 L191,321.7266 L201,321.7266 L191,311.7266 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="22" y="328.7935">adaptorSig = x + aliceSig</text><polygon fill="#A80036" points="651,364.4922,661,368.4922,651,372.4922,655,368.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="210" x2="657" y1="368.4922" y2="368.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="217" y="363.4263">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="107" x="230" y="363.4263">Send adaptorSig</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="705" y1="412.7578" y2="412.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="412.7578" y2="425.7578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="664" x2="705" y1="425.7578" y2="425.7578"/><polygon fill="#A80036" points="674,421.7578,664,425.7578,674,429.7578,670,425.7578" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="670" y="400.1255">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="40" x="683" y="392.5591">Verify:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="164" x="683" y="407.6919">adaptorSig = x + aliceSig</text><path d="M352,390.5586 L352,415.5586 L654,415.5586 L654,400.5586 L644,390.5586 L352,390.5586 " fill="#FBFB77" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M644,390.5586 L644,400.5586 L654,400.5586 L644,390.5586 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="281" x="358" y="407.6255">But Bob doesn't know neither x nor aliceSig!</text><polygon fill="#A80036" points="221,450.8906,211,454.8906,221,458.8906,217,454.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="215" x2="662" y1="454.8906" y2="454.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="9" x="227" y="449.8247">9</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="240" y="449.8247">Send bobSig</text><polygon fill="#A80036" points="451,492.5898,461,496.5898,451,500.5898,455,496.5898" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="210" x2="457" y1="496.5898" y2="496.5898"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="217" y="491.5239">10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="239" y="491.5239">Spend tx with aliceSig + bobSig</text><path d="M93,467.8906 L93,507.8906 L201,507.8906 L201,477.8906 L191,467.8906 L93,467.8906 " fill="#FBFB77" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M191,467.8906 L191,477.8906 L201,477.8906 L191,467.8906 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="99" y="484.9575">Alice receives</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="99" y="500.0903">her GRIN</text><polygon fill="#A80036" points="474,534.2891,464,538.2891,474,542.2891,470,538.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="468" x2="662" y1="538.2891" y2="538.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="480" y="533.2231">11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="502" y="533.2231">Notice Alice spending tx</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="663" x2="705" y1="567.4219" y2="567.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="705" x2="705" y1="567.4219" y2="580.4219"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="664" x2="705" y1="580.4219" y2="580.4219"/><polygon fill="#A80036" points="674,576.4219,664,580.4219,674,584.4219,670,580.4219" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="670" y="562.356">12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="692" y="562.356">Use aliceSig to extract x</text><path d="M475,552.7891 L475,577.7891 L654,577.7891 L654,562.7891 L644,552.7891 L475,552.7891 " fill="#FBFB77" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M644,552.7891 L644,562.7891 L654,562.7891 L644,552.7891 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="481" y="569.856">x = adaptorSig - aliceSig</text><polygon fill="#A80036" points="415,618.1211,405,622.1211,415,626.1211,411,622.1211" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="409" x2="662" y1="622.1211" y2="622.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="18" x="421" y="617.0552">13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="190" x="443" y="617.0552">Spend BTC with Bob's key &amp; x</text><path d="M668,593.4219 L668,633.4219 L771,633.4219 L771,603.4219 L761,593.4219 L668,593.4219 " fill="#FBFB77" filter="url(#f1frk02c3br0k7)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M761,593.4219 L761,603.4219 L771,603.4219 L761,593.4219 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="674" y="610.4888">Bob receives</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="47" x="674" y="625.6216">his BTC</text><!--
@startuml
actor Alice
box "Blockchains"
entity "BTC"
entity "GRIN"
end box
actor Bob

autonumber
Alice -> Alice: Create secret x
Alice -> BTC: Create BTC 2-of-2 MuSig
note left: Spends with: Bob's key & x\nExpires in: 48h
activate BTC
Bob -> BTC: Inspect MuSig
Bob -> GRIN: Create GRIN 2-of-2 MuSig
note right: Spends with: aliceSig + bobSig\nExpires in: 24h
activate GRIN
Alice -> GRIN: Inspect MuSig
Alice -> Alice: Create adaptorSig
note left: adaptorSig = x + aliceSig
Alice -> Bob: Send adaptorSig
Bob -> Bob: Verify:\nadaptorSig = x + aliceSig
note left: But Bob doesn't know neither x nor aliceSig!
Bob -> Alice: Send bobSig
Alice -> GRIN: Spend tx with aliceSig + bobSig
deactivate GRIN
note left: Alice receives\nher GRIN
Bob -> GRIN: Notice Alice spending tx
Bob -> Bob: Use aliceSig to extract x
note left: x = adaptorSig - aliceSig 
Bob -> BTC: Spend BTC with Bob's key & x
note right: Bob receives\nhis BTC
deactivate BTC
@enduml

PlantUML version 1.2019.05(Sat Apr 20 16:45:36 UTC 2019)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Java Version: 1.7.0_25-b15
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>